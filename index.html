<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
    
<body>

    <div class='section-full-screen' id='div-section-address'>
        <title>Solar Solution</title>
        <div class="hero-section">
            <a href="https://www.renewvia.com/">
            <img src="images/Audi Logo.svg"></a>
        </div>

      

        <div class="header1">
            <h2>Solar at My Dealership</h2>
        </div>

        <div class="subtext1">
            <p>Solar Energy can drastically reduce your electricity bills, is financially incentivized, and can be easily installed without disrupting your business. Join Audi dealers across the nation as we drive towards a more sustainable future, today. Based on your needs and geographical location, we will calculate your unique solar solution.</p>
        </div>
        <br/>

        <input placeholder="Dealership Name"text" id="input-address-name"/>
        <br/>
        <br/>
        <div class="row">
            <div class="column1">
                <input placeholder="City" type="text" id="input-address-city"/>
                <br>
                <select id="input-address-state">
                    <option disabled selected value="">State</option>
                    <option value="AL">AL</option>
                    <option value="AK">AK</option>
                    <option value="AR">AR</option>
                    <option value="AZ">AZ</option>
                    <option value="CA">CA</option>
                    <option value="CO">CO</option>
                    <option value="CT">CT</option>
                    <option value="DC">DC</option>
                    <option value="DE">DE</option>
                    <option value="FL">FL</option>
                    <option value="GA">GA</option>
                    <option value="HI">HI</option>
                    <option value="IA">IA</option>
                    <option value="ID">ID</option>
                    <option value="IL">IL</option>
                    <option value="IN">IN</option>
                    <option value="KS">KS</option>
                    <option value="KY">KY</option>
                    <option value="LA">LA</option>
                    <option value="MA">MA</option>
                    <option value="MD">MD</option>
                    <option value="ME">ME</option>
                    <option value="MI">MI</option>
                    <option value="MN">MN</option>
                    <option value="MO">MO</option>
                    <option value="MS">MS</option>
                    <option value="MT">MT</option>
                    <option value="NC">NC</option>
                    <option value="NE">NE</option>
                    <option value="NH">NH</option>
                    <option value="NJ">NJ</option>
                    <option value="NM">NM</option>
                    <option value="NV">NV</option>
                    <option value="NY">NY</option>
                    <option value="ND">ND</option>
                    <option value="OH">OH</option>
                    <option value="OK">OK</option>
                    <option value="OR">OR</option>
                    <option value="PA">PA</option>
                    <option value="RI">RI</option>
                    <option value="SC">SC</option>
                    <option value="SD">SD</option>
                    <option value="TN">TN</option>
                    <option value="TX">TX</option>
                    <option value="UT">UT</option>
                    <option value="VT">VT</option>
                    <option value="VA">VA</option>
                    <option value="WA">WA</option>
                    <option value="WI">WI</option>
                    <option value="WV">WV</option>
                    <option value="WY">WY</option>
                </select>

                <br/>
                <input placeholder="Email" type="text" id="input-address-email"/>
                <br/>

            </div>

            <div class="column2">

                <input placeholder="Street Address" type="text" id="input-address-street" />

                <br/>
                <input placeholder="Zip" type="number" id="input-address-zip"/>
                <br/>

                <input placeholder="Phone Number" type="text" id="input-address-phone"/>
                <br/>

            </div>

        </div>

        <p id="error-message"></p>
        <br/>

        <button id="button-address-next" onclick="onClickAddressNext()">NEXT</button>

    

    </div> <!-- div-section-address -->


    <div class='section-full-screen'  id="div-section-form" hidden>
        <div class="header1">
            <h2>Solar at My Dealership</h2>
        </div>

        <br/>

        <div class="rectangle">
        <br/>

        <div class="row">
            <div class="column">
                <div class="subheader">
                    <h3> What are you interested in?
                        (select all that apply)
                    <h3>
                </div>
                <br/>
        
                <div class="select-section">
                    <input type="checkbox" id="checkbox-rooftop" onclick="doCalculations()">Rooftop Solar</input> 
                    <br/>  
                    <div id="div-form-rooftop" hidden>
                        <div>What is your approximate rooftop area</div>
                        <div>(square feet)</div>
                        <input class="input-form" placeholder="Enter sqft" type="number" id="input-form-sqft"/>
                        <div>Approximately what percentage of above area is available for solar</div>
                        <input class="input-form" placeholder="Enter percentage" type="number" id="input-form-percentage"/>
                        <!--
                        <div class="percent-tect">
                            <p>%</p>
                        </div>
                        -->
                    </div>
                    <br>

                    <input type="checkbox" id="checkbox-canopies" onclick="doCalculations()">Solar Canopies</input> 
                    <br/>
                    <div id="div-form-canopies" hidden>
                        <div> How many parking spaces </div>
                        <input class="input-form" id="input-form-canopies" placeholder="Select Number" type="number" />
                    </div>
                    <br>

                    <input type="checkbox" id="checkbox-chargers" onclick="doCalculations()">EV Chargers</input>
                    <br/>
                    <div id="div-form-chargingstations" hidden>
                        <div>How many units</div>
                        <input class="input-form" id="input-form-chargingstations" placeholder="Select Number" type="number" />
                    </div>  

                <div class="row2">
                    <div class="inner-column1">
                        <img src="images/DJI_0037.jpeg" alt="Carport" style="width:100%">
                    </div>
                    <div class="inner-column2">
                        <img src="images/DJI_0183_2.jpg" alt="Carport" style="width:100%">
                    </div>
                    <div class="inner-column3">
                        <img src="images/DJI_0207_2.jpg" alt="Dealership" style="width:100%">
                    </div>
                    <div class="inner-column4">
                        <img src="images/DJI_0004.jpeg" alt="Dealership" style="width:100%">
                    </div>
                </div>
            </div>
        </div>

        <div class="column">
            <div class="subheader1">
                <h3> Your Solar Solution*</h3>
            </div>
            <br/>  
            <br/>
            <div id=label>Annual Electricity Savings</div><input type="text" id="output-savings" disabled/>
            <div id=label>Total Electricity Savings Over 25 Years of <br> Warrantied Life</div><input type="text" id="output-25years" disabled/>
            <div id=label>Annual Carbon Offset (MT of CO2)</div><input type="text" id="output-carbon" disabled/>
            <div id=label>Total Cost**</div><input type="text" id="output-cost" disabled/>
            <div id=label>Total Tax Benefits <br>(Tax Credit and Depreciation)</div><input type="text" id="output-tax-total" disabled/>
            <div id=label>Net Cost After Tax Benefits</div><input type="text" id="output-netcost" disabled/>        
            <div id=label>Total kW of Electricity Produced</div><input type="text" id="output-pvsize" disabled/>
            <br/>

            <div class="row">
                <div class="small-column">
                    <div class="button-email">
                        <input type="button" id='button-email' value="Get In Touch" onclick="sendEmail()"/>
                        </div>
                        <div class="button-print">
                            <input type="button" id='button-print' onclick="window.print()" value="Print"/>
                            </div>
                            </div>
                        </div>
                    </div>
                <div id="p-thanks" hidden>Thank you! Someone from our team will be in touch with you shortly!</div>
                <br/>
            </div>
        </div>

        <h4><em>*This is a preliminary evaluation, subject to detailed design & enginee
        <br>**Total Cost includes both the installation and cost of the product</em></h4>
    </div> <!-- div-section-form -->

    <div class='section-full-screen'  id="div-section-thanks" hidden>
        <div class="header1">
            <h2> Get In Touch</h2>
        </div>

        <div class="rectangle2">
            <br>
            <div class="subtext1">
                <h7>
                    Your Information Has Been Received and You Will Be Contacted By A Renewvia Energy Professional in 24 hours.
                    <br>
                    <br>
                    Renewvia is Top-500 soral contractor based in Atlanta, GA. We specialize in turning 
                    unused square footage into a cash-generating asset for dealerships, factories, 
                    farms, and any other client with roof or ground space to spare.
                </h7>
                <br>
            </div>
        </div>


        <div class="contact-content">
                <img class="logo" src="images/renewvia-logo-web.jpg">
        <br>

        <h5>
            Solar Progress
            <br>
            Renewvia Energy
            <br>
            <a href="mailto:info@renewvia.com">info@renewvia.com</a>
            <br>404-856-4372
        </h5>

        </div>

    </div> <!-- div-section-thanks -->

    <div class="footer-section">
        <img class="renewvia-logo" src="images/renewvia-logo-web.jpg">
    </div>

</body>



<div class="button">
    <div id="p-thanks" hidden>Thank you! Someone from our team will be in touch with you shortly!</div>
    <br/>
</div>


<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@2/dist/email.min.js"></script>

<script>
    var street=""
    var city="";
    var state="AA";
    var zip=0000;
    var email='';
    var yourName = '';
    var phone ='';

    var canopiesNumberSpaces = 0;
    var chargersNumberSpaces = 0;
    var rooftopTotalSquareFeet = 0;
    var rooftopPercentageAvailable = 0;

    // rate in $/kwh
    var stateEnergyCost=0.00;
    // yeild in kwh/kw
    var stateEnergyYeild=0;

    var isRooftop=false;
    var isCanopies=false;
    var isCanopies=false;

    // constants
    var constSolarPvSizePerSpaceKw=3.096; //based on 9ftx20ft parking space and 17.2W/sqft
    var constCarbonOffsetTonsPerKwh=0.000707;
    var constTaxCreditRate=0.26; //26%
    var constIncomeTaxRate=0.21; //21%
    var constUtilityEscalationRate=0.02;
    var constRooftopSolarWattsSqft=11.6;
    var constChargersSolarCostSpace=15000;
    var constChargersChargerCostEach=5000;
    var constCanopiesSolarCostSpace=10000;
    var constRooftopSolarCostWatt=1.80;



    onLoad();

    function onLoad() {

        var inputs = document.querySelectorAll('[id^="input-form-"]');
        inputs.forEach(function(input) {
            input.onkeydown=doCalculations;
            input.onchange=doCalculations;
            input.onpaste=doCalculations;
            input.oninput=doCalculations;
        });
        /*
        var inputs = document.querySelectorAll('[id^="input-address-"]');
        inputs.forEach(function(input) {
            input.onkeydown=onAddressChange;
            input.onchange=onAddressChange;
            input.onpaste=onAddressChange;
            input.oninput=onAddressChange;
        });
        */

    }

    function onClickAddressNext(){

        street = document.getElementById("input-address-street").value;
        city = document.getElementById("input-address-city").value;
        zip = document.getElementById("input-address-zip").value;
        state = document.getElementById("input-address-state").value;
        email = document.getElementById("input-address-email").value;
        yourName = document.getElementById("input-address-name").value;
        phone = document.getElementById("input-address-phone").value;

        var regexStreet = new RegExp("^.+\ .+$");
        var regexCity = new RegExp("^.+$");
        var regexZip = new RegExp("^[0-9]{5}$");
        var regexState = new RegExp("^[A-Z][A-Z]$");
        var regexEmail = new RegExp("^.+@.+\..+$");
        var regexName = new RegExp("^.+$");
        var regexPhone = new RegExp(".*[0-9].*[0-9].*[0-9].*[0-9].*[0-9].*[0-9].*[0-9].*[0-9].*[0-9].*[0-9].*");
        
        var validStreet = regexStreet.test(street);
        var validCity = regexCity.test(city);
        var validZip = regexZip.test(zip);
        var validSate = regexState.test(state);
        var validEmail = regexEmail.test(email);
        var validName = regexName.test(yourName);
        var validPhone = regexPhone.test(phone);

        if (validSate) {
            stateEnergyCost=stateEnergyCostLookup[state];
            stateEnergyYeild=stateEnergyYeildLookup[state];
        }
        
        var isAdderessValid = (validStreet && validCity && validZip && validSate);
        //document.getElementById("button-address-next").disabled = !isAdderessValid;

        if(!isAdderessValid){
            document.getElementById("error-message").innerHTML="Please enter a valid address for your dealership";
        }
        else if(!(validEmail)){
            document.getElementById("error-message").innerHTML="Please enter an email address";
        }
        else if(!(validPhone)){
            document.getElementById("error-message").innerHTML="Please enter a valid phone number";
        }
        else if(!(validName)){
            document.getElementById("error-message").innerHTML="Please enter the name of the dealership";
        }
        else {
            document.getElementById("div-section-address").hidden = true;
            document.getElementById("div-section-form").hidden = false;
        }
    }

    function doCalculations() {

        canopiesNumberSpaces = document.getElementById("input-form-canopies").value;
        chargersNumberSpaces = document.getElementById("input-form-chargingstations").value;
        rooftopTotalSquareFeet = document.getElementById("input-form-sqft").value;
        rooftopPercentageAvailable = document.getElementById("input-form-percentage").value;

        // get the value of the checkboxes
        isRooftop = document.getElementById("checkbox-rooftop").checked;
        isCanopies = document.getElementById("checkbox-canopies").checked;
        isChargers = document.getElementById("checkbox-chargers").checked;

        // hide/unhide the inputs depending on the checkboxes
        document.getElementById("div-form-canopies").hidden = !isCanopies;
        document.getElementById("div-form-chargingstations").hidden = !isChargers;
        document.getElementById("div-form-rooftop").hidden = !isRooftop;

        // zero out any they are not interested in
        if (!isCanopies){
            canopiesNumberSpaces = 0;
        }

        if (!isChargers){
            chargersNumberSpaces = 0;
        }

        if (!isRooftop){
            rooftopTotalSquareFeet = 0;
            rooftopPercentageAvailable = 0;
        }

        // ev charging spaces
        var chargersTotalSolarPvSizeKw=chargersNumberSpaces*constSolarPvSizePerSpaceKw;
        var chargersTotalCost=(constChargersChargerCostEach+constChargersSolarCostSpace)*chargersNumberSpaces;
        var chargersTotalSolarYeildKwh=constSolarPvSizePerSpaceKw*chargersNumberSpaces*stateEnergyYeild;
        var chargersCarbonOffsetTons=chargersTotalSolarYeildKwh*constCarbonOffsetTonsPerKwh;
        var chargersAnnualElectricitySavings=chargersTotalSolarYeildKwh*stateEnergyCost;
        var chargersTaxCreditOnSoalr=chargersNumberSpaces*constChargersSolarCostSpace*constTaxCreditRate;
        var chargersDepreciationTaxBenefit=(((constChargersSolarCostSpace*chargersNumberSpaces)-(chargersTaxCreditOnSoalr*0.50))*constIncomeTaxRate)+(constChargersChargerCostEach*chargersNumberSpaces*constIncomeTaxRate);
        var chargersNetCostAfterTaxBenefits=chargersTotalCost-(chargersTaxCreditOnSoalr+chargersDepreciationTaxBenefit);
        var chargersTotalElectricitySavings25Year=doElectricitySavingsOverYears(chargersAnnualElectricitySavings, constUtilityEscalationRate, 25);

        // canopy spaces
        var canopiesTotalSolarPvSizeKw=canopiesNumberSpaces*constSolarPvSizePerSpaceKw;
        var canopiesTotalCost=constCanopiesSolarCostSpace*canopiesNumberSpaces;
        var canopiesTotalSolarYeildKwh=constSolarPvSizePerSpaceKw*canopiesNumberSpaces*stateEnergyYeild;
        var canopiesCarbonOffsetTons=canopiesTotalSolarYeildKwh*constCarbonOffsetTonsPerKwh;
        var canopiesAnnualElectricitySavings=canopiesTotalSolarYeildKwh*stateEnergyCost;
        var canopiesTaxCreditOnSoalr=canopiesNumberSpaces*constCanopiesSolarCostSpace*constTaxCreditRate;
        var canopiesDepreciationTaxBenefit=(canopiesTotalCost-canopiesTaxCreditOnSoalr*0.5)*constIncomeTaxRate;
        var canopiesNetCostAfterTaxBenefits=canopiesTotalCost-(canopiesTaxCreditOnSoalr+canopiesDepreciationTaxBenefit);
        var canopiesTotalElectricitySavings25Year=doElectricitySavingsOverYears(canopiesAnnualElectricitySavings, constUtilityEscalationRate, 25);

        // rooftop
        var rooftopTotalSolarPvSizeKw=rooftopTotalSquareFeet*rooftopPercentageAvailable/100*constRooftopSolarWattsSqft/1000;
        var rooftopTotalCost=rooftopTotalSolarPvSizeKw*constRooftopSolarCostWatt*1000;
        var rooftopTotalSolarYeildKwh=rooftopTotalSolarPvSizeKw*stateEnergyYeild;
        var rooftopCarbonOffsetTons=rooftopTotalSolarYeildKwh*constCarbonOffsetTonsPerKwh;
        var rooftopAnnualElectricitySavings=rooftopTotalSolarYeildKwh*stateEnergyCost;
        var rooftopTaxCreditOnSoalr=rooftopTotalCost*constTaxCreditRate;
        var rooftopDepreciationTaxBenefit=(rooftopTotalCost-rooftopTaxCreditOnSoalr*0.5)*constIncomeTaxRate;
        var rooftopNetCostAfterTaxBenefits=rooftopTotalCost-(rooftopTaxCreditOnSoalr+rooftopDepreciationTaxBenefit);
        var rooftopTotalElectricitySavings25Year=doElectricitySavingsOverYears(rooftopAnnualElectricitySavings, constUtilityEscalationRate, 25);

        console.log("do calculation"+totalCarbonOffsetTons);

        var totalSolarPvSizeKw=chargersTotalSolarPvSizeKw+canopiesTotalSolarPvSizeKw+rooftopTotalSolarPvSizeKw;
        var totalCost=chargersTotalCost+canopiesTotalCost+rooftopTotalCost;
        var totalCarbonOffsetTons=chargersCarbonOffsetTons+canopiesCarbonOffsetTons+rooftopCarbonOffsetTons;
        var totalAnnualElectricitySavings=chargersAnnualElectricitySavings+canopiesAnnualElectricitySavings+rooftopAnnualElectricitySavings;
        var totalTaxCreditOnSolar=chargersTaxCreditOnSoalr+canopiesTaxCreditOnSoalr+rooftopTaxCreditOnSoalr;
        var totalDepreciationTaxBenefit=chargersDepreciationTaxBenefit+canopiesDepreciationTaxBenefit+rooftopDepreciationTaxBenefit;
        var totalTaxBenefits=totalTaxCreditOnSolar+totalDepreciationTaxBenefit;
        var totalNetCostAfterTaxBenefits=chargersNetCostAfterTaxBenefits+canopiesNetCostAfterTaxBenefits+rooftopNetCostAfterTaxBenefits;
        var totalSimplePaybackYears=totalNetCostAfterTaxBenefits/totalAnnualElectricitySavings;
        var totalElectricitySavings25Year=chargersTotalElectricitySavings25Year+canopiesTotalElectricitySavings25Year+rooftopTotalElectricitySavings25Year;


        var formatter = new Intl.NumberFormat('en-US', {
            style: 'currency', 
            currency: 'USD', 
            maximumFractionDigits: 2,
            minimumFractionDigits: 2,
            });
            
        document.getElementById("output-pvsize").value=totalSolarPvSizeKw.toLocaleString();
        document.getElementById("output-cost").value=formatter.format(totalCost);
        document.getElementById("output-carbon").value=totalCarbonOffsetTons.toLocaleString();
        document.getElementById("output-savings").value=formatter.format(totalAnnualElectricitySavings);
        document.getElementById("output-tax-total").value=formatter.format(totalTaxBenefits);
        document.getElementById("output-netcost").value=formatter.format(totalNetCostAfterTaxBenefits);
        document.getElementById("output-25years").value=formatter.format(totalElectricitySavings25Year);
    }

    function doElectricitySavingsOverYears(annualSavings, escalationRate, years){
        var escelatedAmount = annualSavings*(1-((1+escalationRate)**years))/(1-(1+escalationRate));
        return escelatedAmount;
    }

    function sendEmail(){
        notesStr = "Form Responses:\n\r";

        addressStr = street + ', ' + city + ', ' + state + ' ' + zip;

        var outPvSize = document.getElementById("output-pvsize").value;
        var outCost = document.getElementById("output-cost").value;
        var outCarbon = document.getElementById("output-carbon").value;
        var outSavings = document.getElementById("output-savings").value;
        var outTaxTotal = document.getElementById("output-tax-total").value;
        var outNetCost = document.getElementById("output-netcost").value;
        var outTfYears = document.getElementById("output-25years").value;

        var templateParams = {
            name: yourName,
            email: email,
            address: addressStr,
            interestCanopies: isCanopies,
            interestChargers: isChargers,
            interestRooftop: isRooftop,
            canopies: canopiesNumberSpaces,
            chargers: chargersNumberSpaces,
            rooftopsqft: rooftopTotalSquareFeet,
            rooftoppercent: rooftopPercentageAvailable,
            phone: phone,
            outPvSize: outPvSize,
            outCost: outCost,
            outCarbon: outCarbon,
            outSavings: outSavings,
            outTaxTotal: outTaxTotal,
            outNetCost: outNetCost,
            outTfYears: outTfYears,
        };
        emailjs.init("user_whFAArlovqbTEMG0eijLf");
        emailjs.send('test-gmail', 'template_ahhaukh', templateParams)
        .then(function(response) {
            console.log('SUCCESS!', response.status, response.text);
        }, function(error) {
            console.log('FAILED...', error);
        });

        document.getElementById("div-section-form").hidden = true;
        document.getElementById("div-section-thanks").hidden = false;
    }


var stateEnergyCostLookup = {
"AK": 0.1980,
"AL": 0.1152, 
"AR": 0.0878, 
"AZ": 0.1025, 
"CA": 0.1667, 
"CO": 0.1043, 
"CT": 0.1675, 
"DC": 0.1226, 
"DE": 0.0953, 
"FL": 0.0927, 
"GA": 0.1002, 
"HI": 0.2923, 
"IA": 0.0999, 
"ID": 0.0767, 
"IL": 0.0908, 
"IN": 0.1103, 
"KS": 0.1029, 
"KY": 0.1015, 
"LA": 0.0891, 
"MA": 0.1680, 
"MD": 0.0997, 
"ME": 0.1283, 
"MI": 0.1139, 
"MN": 0.1034, 
"MO": 0.0907, 
"MS": 0.1052, 
"MT": 0.1041, 
"NC": 0.0881, 
"ND": 0.0901, 
"NE": 0.0885, 
"NH": 0.1593, 
"NJ": 0.1223, 
"NM": 0.0979, 
"NV": 0.0804, 
"NY": 0.1406, 
"OH": 0.0972, 
"OK": 0.0798, 
"OR": 0.0885, 
"PA": 0.0871, 
"RI": 0.1638, 
"SC": 0.1058, 
"SD": 0.0959, 
"TN": 0.1065, 
"TX": 0.0806, 
"UT": 0.0826, 
"VA": 0.0818, 
"VT": 0.1598, 
"WA": 0.0875, 
"WI": 0.1072, 
"WV": 0.0916, 
"WY": 0.0964
};

var stateEnergyYeildLookup = {
"AK": 932,
"AL": 1365,
"AR": 1338,
"AZ": 1667,
"CA": 1523,
"CO": 1496,
"CT": 1215,
"DC": 1306,
"DE": 1325,
"FL": 1403,
"GA": 1378,
"HI": 1654,
"IA": 1279,
"ID": 1367,
"IL": 1317,
"IN": 1277,
"KS": 1358,
"KY": 1276,
"LA": 1446,
"MA": 1228,
"MD": 1307,
"ME": 1182,
"MI": 1216,
"MN": 1224,
"MO": 1289,
"MS": 1403,
"MT": 1224,
"NC": 1351,
"ND": 1239,
"NE": 1346,
"NH": 1208,
"NJ": 1273,
"NM": 1630,
"NV": 1590,
"NY": 1175,
"OH": 1254,
"OK": 1477,
"OR": 1115,
"PA": 1233,
"RI": 1229,
"SC": 1399,
"SD": 1296,
"TN": 1309,
"TX": 1419,
"UT": 1397,
"VA": 1318,
"VT": 1137,
"WA": 1016,
"WI": 1225,
"WV": 1226,
"WY": 1444
};


</script>
